{% extends 'mainapp/base.html' %}
{% load static %}
{% block title %}HomePage{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/homepage.css' %}">       
{% endblock %}

{% block content %}
<div id="row">
    <div class="form-container">
        <h2>Plan Your Trip</h2>
        <form id="trip-form" action="{% url 'mappage' %}" method="post">
            {% csrf_token %}
            <label for="source">Source</label>
            <input type="text" id="source-input" name="source-add" placeholder="Enter source location" required />
            <ul id="source-results" class="autocomplete-results"></ul>
            <input type="hidden" id="source-lat" name="source_lat">
            <input type="hidden" id="source-lng" name="source_lng">

            <label for="destination">Destination</label>
            <input type="text" id="destination-input" name="destination-add" placeholder="Enter destination location" required />
            <ul id="destination-results" class="autocomplete-results"></ul>
            <input type="hidden" id="dest-lat" name="dest_lat">
            <input type="hidden" id="dest-lng" name="dest_lng">

            <!-- Hidden fields for date and time -->
            <input type="hidden" id="search-date" name="search_date">
            <input type="hidden" id="search-time" name="search_time">

            <button type="submit" id="calculate-button">Calculate Carbon Footprint</button>
        </form>
    </div>
    <div class="chats">
        <div class="chat-entries">
            {% if chats %}
                {% for chat in chats %}
                <div class="chat-entry">
                    <div class="chat-row">
                        <div class="chat-column">
                            <p><strong>Source:</strong> {{ chat.source_address }}</p>
                            <p><strong>Destination:</strong> {{ chat.destination_address }}</p>
                            <p><strong>Distance:</strong> {{ chat.distance }} km</p>
                            <p><strong>Duration:</strong> {{ chat.duration }} mins</p>
                            <p><strong>Date:</strong> {{ chat.search_date }}</p>
                            <p><strong>Time:</strong> {{ chat.search_time }}</p>
                        </div>
                        <div class="chat-column">
                            <div class="carbon-footprint">
                                <p><strong>Carbon Footprint:</strong></p>
                                {% for mode, footprint in chat.carbon_footprint.items %}
                                    <p>{{ mode }}: {{ footprint }} g</p>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p>No records found.</p>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/homepage.js' %}"></script>
{% endblock %}
